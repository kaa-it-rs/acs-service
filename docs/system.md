# Общее описание системы

В системе предварительно заданы три пользователя и три роли:

1. Cуперадмин (логин: "localadmin", пароль: "1QaZ2WsX") - имеет все полномочия в системе, что отражено соответствующей ролью `admin`
2. Производитель (логин: "manufacturer", пароль: "123321") - имеет право только добавлять контроллеры в систему при производстве (мутация createOpener)
3. Обычный пользователь (логин: "vasya", пароль: "123456") - может привязывать контроллер к себе зная его серийный номер (мутация updateOpener), изменять его настройки и управлять им.

Контроллер подключается к сервису по веб-сокету и при подключении посылает пакет вида:

```JSON
{ "type":"HELLO", "data": {"serial_number":"111", "version":"1.0.2","nonce":"jdfjksdhfjshfkjsdhkfhk", "barrier_model": "63285f2c43188baf21ddc2f7"} }
```
`nonce` - предназначен для использования в процессе аутентификации при отправке команды контроллеру.

Если контроллера с присланным серийным номером нет в базе, сервис сразу обрывает соединение с таким контроллером.

При ошибке контроллер просылает сервису пакет вида:

```JSON
{"type":"ERROR", "data":{"serial_number":"111", "code":103, "description":"Unauthorized", "details":null}}
```

В случае успешной установки параметров контроллер присылает сервису пакет вида:

```JSON
{"type":"SET","data":{"serial_number":"111"}}
```

Сервер хранит координаты контроллера, его альяс, его описание и аутентификационные данные, необходимые при отправке команд контроллеру сервисом.

Система также содержит подключенный и настроенный `jaeger` посзволяющий отслеживать трассировку API запросов. Веб-интерфейс будет доступен по адресу: [Jaeger](http://localhost:16686).
